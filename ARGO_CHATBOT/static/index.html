<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FloatChat - Ocean Intelligence</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Left Panel - Chat Interface -->
        <aside class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <div class="logo-section">
                    <h1 class="logo">üåä FloatChat</h1>
                    <span class="tagline">Ocean Intelligence</span>
                </div>
                <button class="panel-toggle" id="panelToggle" title="Toggle Panel">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>
            </div>

            <div class="chat-subheader">
                <p>How can I assist you with ocean data?</p>
            </div>

            <!-- Quick Suggestions -->
            <div class="suggestions-section">
                <h3 class="section-title">Quick Suggestions</h3>
                <div class="suggestions-grid">
                    <button class="suggestion-btn" data-query="What are the nearest ARGO floats to Chennai?">
                        <span class="suggestion-icon">üìç</span>
                        <span>Nearest floats to Chennai</span>
                    </button>
                    <button class="suggestion-btn" data-query="Show temperature trends in the Arabian Sea for the last 6 months">
                        <span class="suggestion-icon">üìà</span>
                        <span>Temperature trends in Arabian Sea</span>
                    </button>
                    <button class="suggestion-btn" data-query="What is the average salinity in Bay of Bengal?">
                        <span class="suggestion-icon">üß™</span>
                        <span>Average salinity in Bay of Bengal</span>
                    </button>
                    <button class="suggestion-btn" data-query="Show trajectory of float 2902115">
                        <span class="suggestion-icon">üõ§Ô∏è</span>
                        <span>Float trajectory</span>
                    </button>
                </div>
            </div>

            <!-- Query History -->
            <div class="history-section">
                <h3 class="section-title">
                    <span>Recent Queries</span>
                    <button class="clear-history-btn" id="clearHistory" title="Clear History">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                    </button>
                </h3>
                <div class="history-list" id="historyList">
                    <!-- History items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Chat Messages Area -->
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <div class="welcome-icon">üåä</div>
                    <h2>Welcome to FloatChat!</h2>
                    <p>Ask me anything about ARGO float data - locations, temperatures, salinity, trajectories, and more.</p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="chat-input-area">
                <div class="input-wrapper">
                    <textarea 
                        id="queryInput" 
                        placeholder="Ask about ocean data... (Press Enter to send)"
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" title="Send Query">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>
                <div class="input-hint">
                    <span class="status-indicator" id="statusIndicator">
                        <span class="status-dot online"></span>
                        <span>Connected</span>
                    </span>
                </div>
            </div>
        </aside>

        <!-- Right Panel - Results Display -->
        <main class="results-panel" id="resultsPanel">
            <!-- Map Section -->
            <div class="map-section" id="mapSection">
                <div class="section-header">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                            <line x1="8" y1="2" x2="8" y2="18"></line>
                            <line x1="16" y1="6" x2="16" y2="22"></line>
                        </svg>
                        Ocean Map
                    </h2>
                    <div class="map-controls">
                        <select id="periodYear" class="period-select">
                            <option value="">All Years</option>
                        </select>
                        <select id="periodMonth" class="period-select">
                            <option value="">All Months</option>
                        </select>
                        <button class="map-control-btn" id="fullscreenMap" title="Fullscreen">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="15 3 21 3 21 9"></polyline>
                                <polyline points="9 21 3 21 3 15"></polyline>
                                <line x1="21" y1="3" x2="14" y2="10"></line>
                                <line x1="3" y1="21" x2="10" y2="14"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="map-container" id="mapContainer"></div>
                <div class="map-legend" id="mapLegend">
                    <div class="legend-item">
                        <span class="legend-marker float-marker"></span>
                        <span>Float Location</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-line"></span>
                        <span>Trajectory Path</span>
                    </div>
                </div>
            </div>

            <!-- Data Visualization Section -->
            <div class="visualization-section" id="vizSection">
                <div class="section-header">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="20" x2="18" y2="10"></line>
                            <line x1="12" y1="20" x2="12" y2="4"></line>
                            <line x1="6" y1="20" x2="6" y2="14"></line>
                        </svg>
                        Data Visualization
                    </h2>
                    <div class="viz-controls">
                        <button class="viz-control-btn active" data-view="chart" id="chartViewBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="20" x2="18" y2="10"></line>
                                <line x1="12" y1="20" x2="12" y2="4"></line>
                                <line x1="6" y1="20" x2="6" y2="14"></line>
                            </svg>
                            Chart
                        </button>
                        <button class="viz-control-btn" data-view="table" id="tableViewBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="3" y1="9" x2="21" y2="9"></line>
                                <line x1="3" y1="15" x2="21" y2="15"></line>
                                <line x1="9" y1="3" x2="9" y2="21"></line>
                            </svg>
                            Table
                        </button>
                        <button class="export-btn" id="exportBtn" title="Export Data">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Export
                        </button>
                    </div>
                </div>
                
                <!-- Chart View -->
                <div class="chart-container" id="chartContainer">
                    <canvas id="dataChart"></canvas>
                    <div class="chart-placeholder" id="chartPlaceholder">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <line x1="18" y1="20" x2="18" y2="10"></line>
                            <line x1="12" y1="20" x2="12" y2="4"></line>
                            <line x1="6" y1="20" x2="6" y2="14"></line>
                        </svg>
                        <p>Run a query to see visualizations</p>
                    </div>
                </div>

                <!-- Table View -->
                <div class="table-container hidden" id="tableContainer">
                    <table class="data-table" id="dataTable">
                        <thead id="tableHead"></thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                    <div class="table-placeholder" id="tablePlaceholder">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                        <p>Run a query to see data table</p>
                    </div>
                </div>
            </div>

            <!-- Summary Section -->
            <div class="summary-section" id="summarySection">
                <div class="section-header">
                    <h2>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        Query Summary
                    </h2>
                </div>
                <div class="summary-content" id="summaryContent">
                    <div class="summary-placeholder">
                        <p>Query results and insights will appear here</p>
                    </div>
                </div>
                
                <!-- Stats Cards -->
                <div class="stats-grid" id="statsGrid">
                    <!-- Stats cards will be populated dynamically -->
                </div>

                <!-- SQL Query Display -->
                <div class="sql-section collapsed" id="sqlSection">
                    <button class="sql-toggle" id="sqlToggle">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="16 18 22 12 16 6"></polyline>
                            <polyline points="8 6 2 12 8 18"></polyline>
                        </svg>
                        <span>View SQL Query</span>
                        <svg class="toggle-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <pre class="sql-code" id="sqlCode"></pre>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Analyzing ocean data...</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
